"use strict";(globalThis.webpackChunksacs=globalThis.webpackChunksacs||[]).push([[753],{61753:(mt,A,c)=>{c.r(A),c.d(A,{AuthModule:()=>d});var v=c(88692),_=c(7976),S=c(16256),t=c(64537);class l{constructor(i,e){this.authService=i,this.router=e}canActivate(){return!this.authService.isUserAuthenticated()||(this.router.navigate(["/"]),!1)}canActivateChild(){return console.log("canActivateChild"),!this.authService.isUserAuthenticated()||(this.router.navigate(["/"]),!1)}canDeactivate(){return console.log("canDeactivate"),!0}canLoad(){return console.log("canLoad"),!0}}l.\u0275fac=function(i){return new(i||l)(t.LFG(S.e),t.LFG(_.F0))},l.\u0275prov=t.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"});class p{constructor(){}ngOnInit(){}}p.\u0275fac=function(i){return new(i||p)},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-auth"]],decls:1,vars:0,template:function(i,e){1&i&&t._UZ(0,"router-outlet")},dependencies:[_.lC]});var s=c(20092),y=c(20434),b=c(37730),x=c(80532),C=c(94590),I=c(36198),u=c(34942),q=c(96528),m=c(56707);const L=["usernameRef"],B=["otpCodeRef"];function O(n,i){1&n&&(t.TgZ(0,"button",32),t._uU(1,"BUTTON.SIGNIN"),t.qZA())}function N(n,i){1&n&&(t.TgZ(0,"button",33),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",34),t._uU(3,"\n                                "),t.qZA())}const D=function(n){return{field:n}};function J(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"form",20),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.submitForm())}),t._uU(1,"\n                "),t.TgZ(2,"div",21),t._uU(3,"\n                    FORM.HEADER.LOGIN\n                "),t.qZA(),t._uU(4,"\n                "),t.TgZ(5,"div",6),t._uU(6,"\n                    "),t.TgZ(7,"div",22),t._uU(8,"\n                        "),t.TgZ(9,"div",10),t._uU(10,"\n                            "),t.TgZ(11,"div",11),t._uU(12,"\n                                "),t.TgZ(13,"label",23),t._uU(14,"FORM.LABEL.USER_NAME"),t.qZA(),t._uU(15,"\n                                "),t._UZ(16,"input",24,25),t.ALo(18,"translate"),t._uU(19,"\n                                "),t.TgZ(20,"div",26),t._uU(21,"\n                                    "),t.TgZ(22,"p",27),t.ALo(23,"translate"),t._uU(24,"\n                                        VALIDATION.IS_REQUIRED"),t.qZA(),t._uU(25,"\n                                "),t.qZA(),t._uU(26,"\n                                "),t._uU(27,"\n                            "),t.qZA(),t._uU(28,"\n                            "),t.TgZ(29,"div",11),t._uU(30,"\n                                "),t.TgZ(31,"label",23),t._uU(32,"FORM.LABEL.PASSWORD"),t.qZA(),t._uU(33,"\n                                "),t._UZ(34,"input",28),t.ALo(35,"translate"),t._uU(36,"\n                                "),t.TgZ(37,"div",26),t._uU(38,"\n                                    "),t.TgZ(39,"p",27),t.ALo(40,"translate"),t._uU(41,"\n                                        VALIDATION.IS_REQUIRED"),t.qZA(),t._uU(42,"\n                                "),t.qZA(),t._uU(43,"\n                                "),t._uU(44,"\n                            "),t.qZA(),t._uU(45,"\n                            "),t._uU(46,"\n                            "),t.TgZ(47,"div",29),t._uU(48,"\n                                "),t.YNc(49,O,2,0,"button",30),t._uU(50,"\n                                "),t.YNc(51,N,4,0,"button",31),t._uU(52,"\n                            "),t.qZA(),t._uU(53,"\n                        "),t.qZA(),t._uU(54,"\n                    "),t.qZA(),t._uU(55,"\n\n                "),t.qZA(),t._uU(56,"\n            "),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.formData),t.xp6(16),t.s9C("placeholder",t.lcZ(18,7,"FORM.LABEL.USER_NAME")),t.xp6(6),t.Q6J("translateParams",t.VKq(15,D,t.lcZ(23,9,"FORM.LABEL.USER_NAME"))),t.xp6(12),t.s9C("placeholder",t.lcZ(35,11,"FORM.LABEL.PASSWORD")),t.xp6(5),t.Q6J("translateParams",t.VKq(17,D,t.lcZ(40,13,"FORM.LABEL.PASSWORD"))),t.xp6(10),t.Q6J("ngIf",!e.loading.signinBtn),t.xp6(2),t.Q6J("ngIf",e.loading.signinBtn)}}function w(n,i){1&n&&(t.TgZ(0,"p",35),t._uU(1,"\n                        LOAD.QR_CODE_INSTRUCTION\n                    "),t.qZA())}function E(n,i){if(1&n&&(t.TgZ(0,"div",36),t._uU(1,"\n                        "),t._UZ(2,"img",37),t._uU(3,"\n                    "),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("src",e.responseData.qr_code_url,t.LSH)}}function Q(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",38),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.verifyOTP())}),t._uU(1,"LOAD.SUBMIT"),t.qZA()}}function R(n,i){1&n&&(t.TgZ(0,"button",39),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",34),t._uU(3,"\n                                "),t.qZA())}class f{constructor(i,e,o,r,a,Z,T){this._authService=i,this.utilityService=e,this._notifyService=o,this._localStorageService=r,this._generalService=a,this._router=Z,this._electronService=T,this.formSubmitted=!1,this.loading={signinBtn:!1,otpBtn:!1},this.sendVerifyOTP=!1,this.responseData={},this._electronService.isElectron&&this._router.navigate(["auth/branch/signin"])}ngOnInit(){this.createForm()}ngAfterViewInit(){this.usernameRef.nativeElement.focus()}createForm(){this.formData=new s.cw({username:new s.NI(null,[s.kI.required,s.kI.maxLength(50)]),password:new s.NI(null,[s.kI.required,s.kI.maxLength(50)])})}submitForm(){this.formSubmitted=!0,this.formData.valid&&(this.loading.signinBtn=!0,this._authService.signin(this.formData.value).subscribe({next:i=>{this.loading.signinBtn=!1,this.responseData=i.item,setTimeout(()=>{this.otpCodeRef.nativeElement.focus()},0)},error:i=>{this.loading.signinBtn=!1;let e=this.utilityService.serverMessageHandler(i);this.utilityService.error(e,this._notifyService)}}))}isFieldInvalid(i){return!this.formData.get(i).valid&&(this.formData.get(i).touched||this.formData.get(i).untouched&&this.formSubmitted)}verifyOTP(){this.code&&6==(""+this.code).length&&!this.sendVerifyOTP&&(this.loading.otpBtn=!0,this.sendVerifyOTP=!0,this._authService.validateTotp({token:this.responseData.temp_token,code:""+this.code}).subscribe({next:e=>{this.loading.otpBtn=!1,this.sendVerifyOTP=!1;let o=e.item.center_id;e.item.role_type==x.GD.ADM&&e.user_permissions?.branch_id?.length&&!e.user_permissions?.branch_id?.includes(o)&&(o=e.user_permissions?.branch_id[0]),this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.accessToken,e.token),this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.userDetails,JSON.stringify(e.item)),this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.centerId,o),e?.permissions&&this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.userPermission,JSON.stringify(e?.permissions||[])),this.utilityService.forceUpdateUser(),this.utilityService.success(e.message,this._notifyService),this._router.navigate([e.item.role_type==x.GD.AD?"/super-master":"/master"])},error:e=>{this.loading.otpBtn=!1,this.sendVerifyOTP=!1;let o=this.utilityService.serverMessageHandler(e);this.utilityService.error(o,this._notifyService)}}))}}f.\u0275fac=function(i){return new(i||f)(t.Y36(S.e),t.Y36(b.t),t.Y36(u.c),t.Y36(y.n),t.Y36(I.m),t.Y36(_.F0),t.Y36(C.d))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-signin"]],viewQuery:function(i,e){if(1&i&&(t.Gf(L,5),t.Gf(B,5)),2&i){let o;t.iGM(o=t.CRH())&&(e.usernameRef=o.first),t.iGM(o=t.CRH())&&(e.otpCodeRef=o.first)}},decls:54,vars:9,consts:[[1,"container"],[1,"row","mx-0","height-full","align-items-center"],[1,"cell-5"],["class","card form-box","data-role","validator","data-interactive-check","true",3,"formGroup","ngSubmit",4,"ngIf"],[1,"card","form-box",3,"hidden"],["translate","",1,"card-header","text-center","pb-0"],[1,"card-content","pt-0"],["class","font-14 text-center mt-5 mb-0","translate","",4,"ngIf"],["class","qr-code mt-5",4,"ngIf"],[1,"row","mt-5"],[1,"cell-12"],[1,"form-group"],[1,"otp-inputs"],["type","number","name","code","appCommonDirective","",3,"ngModel","type","limit","ngModelChange","keydown.enter"],["otpCode","ngModel","otpCodeRef",""],[1,"form-group","mt-7","d-flex","justify-content-center"],["type","button","m4-button","","btn-style","primary","class","justify-content-center","translate","",3,"click",4,"ngIf"],["type","button","m4-button","","btn-style","primary","class","justify-content-center","translate","",4,"ngIf"],[1,"cell-7"],["src","assets/images/login-img.png","alt","Login Image",1,"d-block","ml-auto"],["data-role","validator","data-interactive-check","true",1,"card","form-box",3,"formGroup","ngSubmit"],["translate","",1,"card-header"],[1,"row"],["translate",""],["type","text","name","username","id","username","formControlName","username","data-validate","required",3,"placeholder"],["usernameRef",""],[1,"invalid_feedback"],["translate","",3,"translateParams"],["type","password","name","password","id","password","formControlName","password","data-validate","required",3,"placeholder"],[1,"form-group","mt-2"],["type","submit","m4-button","","btn-style","primary","class","w-100","translate","",4,"ngIf"],["type","button","m4-button","","btn-style","primary","class","w-100","translate","",4,"ngIf"],["type","submit","m4-button","","btn-style","primary","translate","",1,"w-100"],["type","button","m4-button","","btn-style","primary","translate","",1,"w-100"],["icon","spinner","m4-animation","spin"],["translate","",1,"font-14","text-center","mt-5","mb-0"],[1,"qr-code","mt-5"],["alt","",3,"src"],["type","button","m4-button","","btn-style","primary","translate","",1,"justify-content-center",3,"click"],["type","button","m4-button","","btn-style","primary","translate","",1,"justify-content-center"]],template:function(i,e){1&i&&(t._uU(0,"\n"),t.TgZ(1,"div",0),t._uU(2,"\n    "),t.TgZ(3,"div",1),t._uU(4,"\n        "),t.TgZ(5,"div",2),t._uU(6,"\n            "),t._uU(7,"\n            "),t._uU(8,"\n            "),t.YNc(9,J,57,19,"form",3),t._uU(10,"\n\n            "),t.TgZ(11,"form",4),t._uU(12,"\n                "),t.TgZ(13,"div",5),t._uU(14,"\n                    LOAD.TWO_STEP_VERIFICATION\n                "),t.qZA(),t._uU(15,"\n                "),t.TgZ(16,"div",6),t._uU(17,"\n                    "),t.YNc(18,w,2,0,"p",7),t._uU(19,"\n                    "),t.YNc(20,E,4,1,"div",8),t._uU(21,"\n                    "),t.TgZ(22,"div",9),t._uU(23,"\n                        "),t.TgZ(24,"div",10),t._uU(25,"\n                            "),t.TgZ(26,"div",11),t._uU(27,"\n                                "),t.TgZ(28,"div",12),t._uU(29,"\n                                    "),t.TgZ(30,"input",13,14),t.NdJ("ngModelChange",function(r){return e.code=r})("keydown.enter",function(){return e.verifyOTP()}),t.qZA(),t._uU(33,"\n                                "),t.qZA(),t._uU(34,"\n                            "),t.qZA(),t._uU(35,"\n                            "),t.TgZ(36,"div",15),t._uU(37,"\n                                "),t.YNc(38,Q,2,0,"button",16),t._uU(39,"\n                                "),t.YNc(40,R,4,0,"button",17),t._uU(41,"\n                            "),t.qZA(),t._uU(42,"\n                        "),t.qZA(),t._uU(43,"\n                    "),t.qZA(),t._uU(44,"\n                "),t.qZA(),t._uU(45,"\n            "),t.qZA(),t._uU(46,"\n        "),t.qZA(),t._uU(47,"\n        "),t.TgZ(48,"div",18),t._uU(49,"\n            "),t._UZ(50,"img",19),t._uU(51,"\n        "),t.qZA(),t._uU(52,"\n    "),t.qZA(),t._uU(53,"\n\n"),t.qZA()),2&i&&(t.xp6(9),t.Q6J("ngIf",!e.responseData.is_totp_required),t.xp6(2),t.Q6J("hidden",!e.responseData.is_totp_required),t.xp6(7),t.Q6J("ngIf",e.responseData.show_qr_code),t.xp6(2),t.Q6J("ngIf",e.responseData.show_qr_code&&e.responseData.qr_code_url),t.xp6(10),t.Q6J("ngModel",e.code)("type","maxCharLimit")("limit",6),t.xp6(8),t.Q6J("ngIf",!e.loading.otpBtn),t.xp6(2),t.Q6J("ngIf",e.loading.otpBtn))},dependencies:[v.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,q.z,s.On,s.F,u.Hq,u.oJ,u.Vy,m.Pi,m.X$]});var M=c(11208);function F(n,i){1&n&&(t.TgZ(0,"div",24),t._uU(1,"\n                    LOAD.SELECT_CENTER\n                "),t.qZA())}function Y(n,i){1&n&&(t.TgZ(0,"div",24),t._uU(1,"\n                    LOAD.OTP\n                "),t.qZA())}const U=function(n){return{field:n}};function P(n,i){1&n&&(t.TgZ(0,"p",32),t.ALo(1,"translate"),t._uU(2,"\n                                        VALIDATION.IS_REQUIRED\n                                    "),t.qZA()),2&n&&t.Q6J("translateParams",t.VKq(3,U,t.lcZ(1,1,"LOAD.CENTER")))}function V(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e),t.oxw(2);const r=t.MAs(1),a=t.oxw();return t.KtG(a.submitCenter(r))}),t._uU(1,"LOAD.SUBMIT"),t.qZA()}if(2&n){t.oxw(2);const e=t.MAs(1);t.Q6J("disabled",!e.valid)}}function k(n,i){1&n&&(t.TgZ(0,"button",34),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",35),t._uU(3,"\n                                "),t.qZA())}function G(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",25),t._uU(1,"\n                        "),t.TgZ(2,"div",11),t._uU(3,"\n                            "),t.TgZ(4,"div",12),t._uU(5,"\n                                "),t.TgZ(6,"ng-select",26,27),t.NdJ("ngModelChange",function(r){t.CHM(e);const a=t.oxw(2);return t.KtG(a.licenceData.center_id=r)}),t.qZA(),t._uU(8,"\n                                "),t.TgZ(9,"div",28),t._uU(10,"\n                                    "),t.YNc(11,P,3,5,"p",29),t._uU(12,"\n                                "),t.qZA(),t._uU(13,"\n                            "),t.qZA(),t._uU(14,"\n                        "),t.qZA(),t._uU(15,"\n                        "),t.TgZ(16,"div",11),t._uU(17,"\n                            "),t.TgZ(18,"div",30),t._uU(19,"\n                                "),t.YNc(20,V,2,1,"button",31),t._uU(21,"\n                                "),t.YNc(22,k,4,0,"button",17),t._uU(23,"\n                            "),t.qZA(),t._uU(24,"\n                        "),t.qZA(),t._uU(25,"\n                    "),t.qZA()}if(2&n){const e=t.MAs(7);t.oxw();const o=t.MAs(1),r=t.oxw();t.xp6(6),t.Q6J("ngModel",r.licenceData.center_id)("items",r.centerList)("selectOnTab",!0)("clearable",!1)("virtualScroll",!0),t.xp6(5),t.Q6J("ngIf",e.errors&&(e.dirty||e.touched||o.submitted)),t.xp6(9),t.Q6J("ngIf",!r.loading.centerBtn),t.xp6(2),t.Q6J("ngIf",r.loading.centerBtn)}}function H(n,i){1&n&&(t.TgZ(0,"p",32),t.ALo(1,"translate"),t._uU(2,"\n                                            VALIDATION.IS_REQUIRED\n                                        "),t.qZA()),2&n&&t.Q6J("translateParams",t.VKq(3,U,t.lcZ(1,1,"LOAD.CODE")))}function j(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e),t.oxw(2);const r=t.MAs(1),a=t.oxw();return t.KtG(a.validateLicence(r))}),t._uU(1,"LOAD.SUBMIT"),t.qZA()}if(2&n){t.oxw(2);const e=t.MAs(1);t.Q6J("disabled",!e.valid)}}function K(n,i){1&n&&(t.TgZ(0,"button",34),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",35),t._uU(3,"\n                                "),t.qZA())}function W(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",25),t._uU(1,"\n                        "),t.TgZ(2,"div",11),t._uU(3,"\n                            "),t.TgZ(4,"div",12),t._uU(5,"\n                                "),t.TgZ(6,"div",36),t._uU(7,"\n                                    "),t.TgZ(8,"input",37,38),t.NdJ("ngModelChange",function(r){t.CHM(e);const a=t.oxw(2);return t.KtG(a.licenceValidationData.code=r)}),t.qZA(),t._uU(10,"\n                                    "),t.TgZ(11,"div",28),t._uU(12,"\n                                        "),t.YNc(13,H,3,5,"p",29),t._uU(14,"\n                                    "),t.qZA(),t._uU(15,"\n                                "),t.qZA(),t._uU(16,"\n                            "),t.qZA(),t._uU(17,"\n                        "),t.qZA(),t._uU(18,"\n                        "),t.TgZ(19,"div",11),t._uU(20,"\n                            "),t.TgZ(21,"div",39),t._uU(22,"\n                                "),t.TgZ(23,"h6",40)(24,"strong"),t._uU(25),t.qZA()(),t._uU(26,"\n                            "),t.qZA(),t._uU(27,"\n                        "),t.qZA(),t._uU(28,"\n                        "),t.TgZ(29,"div",11),t._uU(30,"\n                            "),t.TgZ(31,"div",30),t._uU(32,"\n                                "),t.YNc(33,j,2,1,"button",31),t._uU(34,"\n                                "),t.YNc(35,K,4,0,"button",17),t._uU(36,"\n                            "),t.qZA(),t._uU(37,"\n                        "),t.qZA(),t._uU(38,"\n                    "),t.qZA()}if(2&n){const e=t.MAs(9);t.oxw();const o=t.MAs(1),r=t.oxw();t.xp6(8),t.Q6J("ngModel",r.licenceValidationData.code)("type","maxCharLimit")("limit",6),t.xp6(5),t.Q6J("ngIf",e.errors&&(e.dirty||e.touched||o.submitted)),t.xp6(12),t.Oqu(r.licenceMessage),t.xp6(8),t.Q6J("ngIf",!r.loading.licenseBtn),t.xp6(2),t.Q6J("ngIf",r.loading.licenseBtn)}}function z(n,i){if(1&n&&(t.TgZ(0,"form",20,21),t._uU(2,"\n                "),t.YNc(3,F,2,0,"div",22),t._uU(4,"\n                "),t.YNc(5,Y,2,0,"div",22),t._uU(6,"\n                "),t.TgZ(7,"div",7),t._uU(8,"\n                    "),t.YNc(9,G,26,8,"div",23),t._uU(10,"\n                    "),t.YNc(11,W,39,7,"div",23),t._uU(12,"\n                "),t.qZA(),t._uU(13,"\n            "),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",!e.licenceData.submitted),t.xp6(2),t.Q6J("ngIf",e.licenceData.submitted),t.xp6(4),t.Q6J("ngIf",!e.licenceData.submitted),t.xp6(2),t.Q6J("ngIf",e.licenceData.submitted)}}function X(n,i){1&n&&(t.TgZ(0,"p",32),t.ALo(1,"translate"),t._uU(2,"\n                                            VALIDATION.IS_REQUIRED\n                                        "),t.qZA()),2&n&&t.Q6J("translateParams",t.VKq(3,U,t.lcZ(1,1,"FORM.LABEL.USER_NAME")))}function $(n,i){if(1&n&&(t.ynx(0),t._uU(1,"\n                                        "),t.YNc(2,X,3,5,"p",29),t._uU(3,"\n                                    "),t.BQk()),2&n){t.oxw();const e=t.MAs(19);t.xp6(2),t.Q6J("ngIf",e.errors.required)}}function tt(n,i){1&n&&(t.TgZ(0,"p",32),t.ALo(1,"translate"),t._uU(2,"\n                                            VALIDATION.IS_REQUIRED\n                                        "),t.qZA()),2&n&&t.Q6J("translateParams",t.VKq(3,U,t.lcZ(1,1,"FORM.LABEL.PASSWORD")))}function et(n,i){if(1&n&&(t.ynx(0),t._uU(1,"\n                                        "),t.YNc(2,tt,3,5,"p",29),t._uU(3,"\n                                    "),t.BQk()),2&n){t.oxw();const e=t.MAs(34);t.xp6(2),t.Q6J("ngIf",e.errors.required)}}function nt(n,i){1&n&&(t.TgZ(0,"button",53),t._uU(1,"BUTTON.SIGNIN"),t.qZA())}function it(n,i){1&n&&(t.TgZ(0,"button",54),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",35),t._uU(3,"\n                                "),t.qZA())}function ot(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"form",41,42),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.MAs(1),a=t.oxw();return t.KtG(a.submitForm(r))}),t._uU(2,"\n                "),t.TgZ(3,"div",43),t._uU(4,"\n                    FORM.HEADER.LOGIN\n                "),t.qZA(),t._uU(5,"\n                "),t.TgZ(6,"div",7),t._uU(7,"\n                    "),t.TgZ(8,"div",25),t._uU(9,"\n                        "),t.TgZ(10,"div",11),t._uU(11,"\n                            "),t._uU(12,"\n                            "),t.TgZ(13,"div",12),t._uU(14,"\n                                "),t.TgZ(15,"label",44),t._uU(16,"FORM.LABEL.USER_NAME"),t.qZA(),t._uU(17,"\n                                "),t.TgZ(18,"input",45,46),t.NdJ("ngModelChange",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.formData.username=r)}),t.ALo(20,"translate"),t.qZA(),t._uU(21,"\n                                "),t.TgZ(22,"div",28),t._uU(23,"\n                                    "),t.YNc(24,$,4,1,"ng-container",47),t._uU(25,"\n                                "),t.qZA(),t._uU(26,"\n                            "),t.qZA(),t._uU(27,"\n                            "),t.TgZ(28,"div",12),t._uU(29,"\n                                "),t.TgZ(30,"label",44),t._uU(31,"FORM.LABEL.PASSWORD"),t.qZA(),t._uU(32,"\n                                "),t.TgZ(33,"input",48,49),t.NdJ("ngModelChange",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.formData.password=r)}),t.ALo(35,"translate"),t.qZA(),t._uU(36,"\n                                "),t.TgZ(37,"div",28),t._uU(38,"\n                                    "),t.YNc(39,et,4,1,"ng-container",47),t._uU(40,"\n                                "),t.qZA(),t._uU(41,"\n                            "),t.qZA(),t._uU(42,"\n                            "),t.TgZ(43,"div",50),t._uU(44,"\n                                "),t.YNc(45,nt,2,0,"button",51),t._uU(46,"\n                                "),t.YNc(47,it,4,0,"button",52),t._uU(48,"\n                              "),t.qZA(),t._uU(49,"\n                        "),t.qZA(),t._uU(50,"\n                    "),t.qZA(),t._uU(51,"\n                   \n                "),t.qZA(),t._uU(52,"\n            "),t.qZA()}if(2&n){const e=t.MAs(1),o=t.MAs(19),r=t.MAs(34),a=t.oxw();t.xp6(18),t.s9C("placeholder",t.lcZ(20,8,"FORM.LABEL.USER_NAME")),t.Q6J("ngModel",a.formData.username),t.xp6(6),t.Q6J("ngIf",o.errors&&(o.dirty||o.touched||e.submitted)),t.xp6(9),t.s9C("placeholder",t.lcZ(35,10,"FORM.LABEL.PASSWORD")),t.Q6J("ngModel",a.formData.password),t.xp6(6),t.Q6J("ngIf",r.errors&&(r.dirty||r.touched||e.submitted)),t.xp6(6),t.Q6J("ngIf",!a.loading.button),t.xp6(2),t.Q6J("ngIf",a.loading.button)}}function rt(n,i){1&n&&(t.TgZ(0,"p",55),t._uU(1,"\n                        LOAD.QR_CODE_INSTRUCTION\n                    "),t.qZA())}function st(n,i){if(1&n&&(t.TgZ(0,"div",56),t._uU(1,"\n                        "),t._UZ(2,"img",57),t._uU(3,"\n                    "),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("src",e.responseData.qr_code_url,t.LSH)}}function at(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",58),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.verifyOTP())}),t._uU(1,"LOAD.SUBMIT"),t.qZA()}}function ct(n,i){1&n&&(t.TgZ(0,"button",34),t._uU(1,"\n                                    "),t._UZ(2,"m4-icon",35),t._uU(3,"\n                                "),t.qZA())}class h{constructor(i,e,o,r,a,Z,T,_t){this._authService=i,this.utilityService=e,this._generalService=o,this._notifyService=r,this._electronService=a,this._localStorageService=Z,this._router=T,this._translateService=_t,this.licenceMessage="",this.licenceData={center_id:""},this.licenceValidationData={center_id:"",code:""},this.formData={username:"",password:"",center_id:null},this.loading={button:!1,list:!1,otpBtn:!1,centerBtn:!1,licenseBtn:!1},this.centerList=[],this.responseData={},this.sendVerifyOTP=!1,this.queryParam={sort:"",sortBy:"",skip:"",limit:"",q:"",zone_id:0,center_type:0,state_id:0},this.registeredUser=this._localStorageService.getLocalStorageItem(this.utilityService.localStrorage.registeredUser),this.formData.center_id=this._localStorageService.getLocalStorageItem(this.utilityService.localStrorage.centerId)}ngOnInit(){this.registeredUser||this.getCenterListing()}getCenterListing(){this.loading.list=!0,this._generalService.getCenterListWithoutToken("center",this.queryParam).subscribe({next:i=>{this.centerList=i.list,this.loading.list=!1},error:i=>{this.loading.list=!1}})}submitForm(i){i.valid&&(this.loading.button=!0,this.formData.center_id=this.formData.center_id?+this.formData.center_id:0,this._authService.signinBranch(this.formData).subscribe({next:e=>{this.loading.button=!1,this.responseData=e.item},error:e=>{this.loading.button=!1;let o=this.utilityService.serverMessageHandler(e);this.utilityService.error(o,this._notifyService)}}))}verifyOTP(){6==(""+this.code).length&&!this.sendVerifyOTP&&(this.loading.otpBtn=!0,this.sendVerifyOTP=!0,this._authService.validateTotp({token:this.responseData.temp_token,code:""+this.code}).subscribe({next:e=>{this.loading.otpBtn=!1,this.sendVerifyOTP=!1,this.setLocalStorageData("",e),this.utilityService.success(e.message,this._notifyService),this.utilityService.forceUpdateUser(),this._router.navigate(this.registeredUser?["/dashboard"]:["/master/center-master-setup"])},error:e=>{this.loading.otpBtn=!1,this.sendVerifyOTP=!1;let o=this.utilityService.serverMessageHandler(e);this.utilityService.error(o,this._notifyService)}}))}submitCenter(i){i.valid&&(this.loading.centerBtn=!0,this._authService.centerSelection(this.licenceData).subscribe({next:e=>{this.loading.centerBtn=!1,this.licenceData.submitted=!0,this.licenceMessage=e.message},error:e=>{this.loading.centerBtn=!1;let o=this.utilityService.serverMessageHandler(e);this.utilityService.error(o,this._notifyService)}}))}setLocalStorageData(i,e){i?(this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.registeredUser,i),this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.centerId,this.licenceValidationData.center_id)):(this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.accessToken,e.token),this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.userDetails,JSON.stringify(e.item)),e?.permissions&&this._localStorageService.setLocalStorageItem(this.utilityService.localStrorage.userPermission,JSON.stringify(e.permissions||[])))}validateLicence(i){i.valid&&(this.loading.licenseBtn=!0,this.licenceValidationData.center_id=this.licenceData.center_id,this._authService.validateLicence(this.licenceValidationData).subscribe({next:e=>{this.loading.licenseBtn=!1,this.registeredUser="1",this.licenceValidationData.validated=!0,this.formData.center_id=this.licenceValidationData.center_id,this.setLocalStorageData(this.registeredUser,{})},error:e=>{this.loading.licenseBtn=!1;let o=this.utilityService.serverMessageHandler(e);this.utilityService.error(o,this._notifyService)}}))}}h.\u0275fac=function(i){return new(i||h)(t.Y36(S.e),t.Y36(b.t),t.Y36(I.m),t.Y36(u.c),t.Y36(C.d),t.Y36(y.n),t.Y36(_.F0),t.Y36(m.sK))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-signin-bm"]],decls:51,vars:10,consts:[[1,"container"],[1,"row","mx-0","height-full","align-items-center"],[1,"cell-5"],["class","card form-box",4,"ngIf"],["class","card form-box",3,"ngSubmit",4,"ngIf"],[1,"card","form-box",3,"hidden"],["translate","",1,"card-header","text-center","pb-0"],[1,"card-content","pt-0"],["class","font-14 text-center mt-5 mb-0","translate","",4,"ngIf"],["class","qr-code mt-5",4,"ngIf"],[1,"row","mt-5"],[1,"cell-12"],[1,"form-group"],[1,"otp-inputs"],["type","number","name","code","appCommonDirective","",3,"ngModel","type","limit","ngModelChange","keydown.enter"],[1,"form-group","mt-7","d-flex","justify-content-center"],["type","button","m4-button","","btn-style","primary","class","justify-content-center","translate","",3,"click",4,"ngIf"],["type","button","m4-button","","btn-style","primary","class","justify-content-center","translate","",4,"ngIf"],[1,"cell-7"],["src","assets/images/login-img.png","alt","Login Image",1,"d-block","ml-auto"],[1,"card","form-box"],["licenceForm","ngForm"],["class","card-header text-center","translate","",4,"ngIf"],["class","row",4,"ngIf"],["translate","",1,"card-header","text-center"],[1,"row"],["bindValue","center_id","bindLabel","center_name","name","centerId","required","",3,"ngModel","items","selectOnTab","clearable","virtualScroll","ngModelChange"],["centerId","ngModel"],[1,"required-wrapper"],["translate","",3,"translateParams",4,"ngIf"],[1,"form-group","d-flex","justify-content-center"],["type","button","m4-button","","btn-style","primary","class","justify-content-center","translate","",3,"disabled","click",4,"ngIf"],["translate","",3,"translateParams"],["type","button","m4-button","","btn-style","primary","translate","",1,"justify-content-center",3,"disabled","click"],["type","button","m4-button","","btn-style","primary","translate","",1,"justify-content-center"],["icon","spinner","m4-animation","spin"],[1,"otp-inputs","d-block"],["type","text","name","licence_code","appCommonDirective","","required","",1,"w-100",3,"ngModel","type","limit","ngModelChange"],["licencCode","ngModel"],[1,"d-flex","justify-content-center"],[1,"text-primary"],[1,"card","form-box",3,"ngSubmit"],["form","ngForm"],["translate","",1,"card-header"],["translate",""],["type","text","name","username","id","username","required","",3,"ngModel","placeholder","ngModelChange"],["username","ngModel"],[4,"ngIf"],["type","password","name","password","id","password","required","",3,"ngModel","placeholder","ngModelChange"],["password","ngModel"],[1,"form-group","mt-2"],["type","submit","m4-button","","btn-style","primary","class","w-100","translate","",4,"ngIf"],["type","button","m4-button","","btn-style","primary","class","w-100","translate","",4,"ngIf"],["type","submit","m4-button","","btn-style","primary","translate","",1,"w-100"],["type","button","m4-button","","btn-style","primary","translate","",1,"w-100"],["translate","",1,"font-14","text-center","mt-5","mb-0"],[1,"qr-code","mt-5"],["alt","",3,"src"],["type","button","m4-button","","btn-style","primary","translate","",1,"justify-content-center",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t._uU(1,"\n    "),t.TgZ(2,"div",1),t._uU(3,"\n        "),t.TgZ(4,"div",2),t._uU(5,"\n            "),t.YNc(6,z,14,4,"form",3),t._uU(7,"\n\n            "),t.YNc(8,ot,53,12,"form",4),t._uU(9,"\n\n            "),t.TgZ(10,"form",5),t._uU(11,"\n                "),t.TgZ(12,"div",6),t._uU(13,"\n                    LOAD.TWO_STEP_VERIFICATION\n                "),t.qZA(),t._uU(14,"\n                "),t.TgZ(15,"div",7),t._uU(16,"\n                    "),t.YNc(17,rt,2,0,"p",8),t._uU(18,"\n                    "),t.YNc(19,st,4,1,"div",9),t._uU(20,"\n                    "),t.TgZ(21,"div",10),t._uU(22,"\n                        "),t.TgZ(23,"div",11),t._uU(24,"\n                            "),t.TgZ(25,"div",12),t._uU(26,"\n                                "),t.TgZ(27,"div",13),t._uU(28,"\n                                    "),t.TgZ(29,"input",14),t.NdJ("ngModelChange",function(r){return e.code=r})("keydown.enter",function(){return e.verifyOTP()}),t.qZA(),t._uU(30,"\n                                "),t.qZA(),t._uU(31,"\n                            "),t.qZA(),t._uU(32,"\n                            "),t.TgZ(33,"div",15),t._uU(34,"\n                                "),t.YNc(35,at,2,0,"button",16),t._uU(36,"\n                                "),t.YNc(37,ct,4,0,"button",17),t._uU(38,"\n                            "),t.qZA(),t._uU(39,"\n                        "),t.qZA(),t._uU(40,"\n                    "),t.qZA(),t._uU(41,"\n\n                "),t.qZA(),t._uU(42,"\n            "),t.qZA(),t._uU(43,"\n        "),t.qZA(),t._uU(44,"\n        "),t.TgZ(45,"div",18),t._uU(46,"\n            "),t._UZ(47,"img",19),t._uU(48,"\n        "),t.qZA(),t._uU(49,"\n    "),t.qZA(),t._uU(50,"\n\n"),t.qZA()),2&i&&(t.xp6(6),t.Q6J("ngIf",!e.registeredUser),t.xp6(2),t.Q6J("ngIf",!e.responseData.is_totp_required&&e.registeredUser),t.xp6(2),t.Q6J("hidden",!e.responseData.is_totp_required),t.xp6(7),t.Q6J("ngIf",e.responseData.show_qr_code),t.xp6(2),t.Q6J("ngIf",e.responseData.show_qr_code&&e.responseData.qr_code_url),t.xp6(10),t.Q6J("ngModel",e.code)("type","maxCharLimit")("limit",6),t.xp6(6),t.Q6J("ngIf",!e.loading.otpBtn),t.xp6(2),t.Q6J("ngIf",e.loading.otpBtn))},dependencies:[v.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,q.z,s.On,s.F,u.Hq,u.oJ,u.Vy,M.w9,m.Pi,m.X$]});const ut=[{path:"",component:p,children:[{path:"",redirectTo:"signin",pathMatch:"full"},{path:"signin",canActivate:[l],component:f},{path:"branch/signin",canActivate:[l],component:h}]}];class g{}g.\u0275fac=function(i){return new(i||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({imports:[_.Bz.forChild(ut),_.Bz]});var lt=c(35540);class d{}d.\u0275fac=function(i){return new(i||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[v.ez,g,s.UX,lt.o,s.u5,u.L3,M.A0,m.aw.forChild()]})}}]);